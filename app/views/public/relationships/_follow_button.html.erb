<% return unless user_signed_in? %>
<% return if current_user&.guest_user? %>
<% return if user == current_user %>

<% rel = current_user.active_relationships.find_by(followed_id: user.id) %>

<% if rel.present? %>
  <%= button_to "フォロー解除",
      relationship_path(rel),
      method: :delete,
      form: { data: { turbo: true } },
      class: "btn btn-outline-danger btn-sm" %>
<% else %>
  <%= button_to "フォローする",
      relationships_path(followed_id: user.id),
      method: :post,
      form: { data: { turbo: true } },
      class: "btn btn-primary btn-sm" %>
<% end %>