<h2>
  <% if @user == current_user %>
    マイページ<i class="fa-solid fa-person-running"></i>
  <% else %>
    <%= @user.name %>さんの詳細<i class="fa-solid fa-person-running"></i>
  <% end %>
</h2>

<p>名前：<%= @user.name %></p>


<% if @user == current_user %>
  <p>Email：<%= @user.email %></p>
<% end %>

<% if @user.bio.present? %>
  <p><strong>自己紹介</strong></p>
  <p><%= simple_format(h(@user.bio)) %></p>
<% end %>



<% if user_signed_in? && !current_user.guest_user? && @user == current_user %>
  <p>
    <%= link_to "プロフィール編集", edit_user_registration_path %>
  </p>
  
<% end %>


<% if user_signed_in? && @user != current_user %>
  <% unless current_user&.guest_user? %>
    <% if current_user.following?(@user) %>
      <% rel = current_user.active_relationships.find_by(followed_id: @user.id) %>
      <%= button_to "フォロー解除", relationship_path(rel), method: :delete %>
    <% else %>
      <%= button_to "フォローする", relationships_path(followed_id: @user.id), method: :post %>
    <% end %>
  <% end %>
<% end %>


<% unless current_user&.guest_user? %>
    <%= link_to "フォロー：#{@user.following.count}", following_user_path(@user) %>
    <%= link_to "フォロワー：#{@user.followers.count}", followers_user_path(@user) %>
<% end %>

<% unless current_user&.guest_user? %>
  <h3>投稿一覧</h3>
<% end %>

<% unless current_user&.guest_user? %>
  <p><%= link_to "新規投稿", new_post_path %></p>
<% end %>


<% @posts.each do |post| %>
  <div>
    <p>
      <%= link_to post.title, post_path(post) %>
      <% if user_signed_in? && @user == current_user %>
        （<%= post.is_public ? "公開" : "非公開" %>）
      <% end %>
    </p>

    <p><%= simple_format(post.body) %></p>

    <small>
      投稿日：<%= l post.created_at, format: :short %>
    </small>

    <hr>
  </div>
<% end %>
